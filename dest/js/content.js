!function e(t,n,r){function i(s,u){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var a=n[s]={exports:{}};t[s][0].call(a.exports,function(e){var n=t[s][1][e];return i(n?n:e)},a,a.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){t.exports=function(){var t=e("events"),n={};return n.createDomain=n.create=function(){function e(e){n.emit("error",e)}var n=new t.EventEmitter;return n.add=function(t){t.on("error",e)},n.remove=function(t){t.removeListener("error",e)},n.bind=function(t){return function(){var n=Array.prototype.slice.call(arguments);try{t.apply(null,n)}catch(r){e(r)}}},n.intercept=function(t){return function(n){if(n)e(n);else{var r=Array.prototype.slice.call(arguments,1);try{t.apply(null,r)}catch(n){e(n)}}}},n.run=function(t){try{t()}catch(n){e(n)}return this},n.dispose=function(){return this.removeAllListeners(),this},n.enter=n.exit=function(){return this},n},n}.call(this)},{events:2}],2:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function u(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,o,c,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],u(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),c=1;r>c;c++)o[c-1]=arguments[c];n.apply(this,o)}else if(s(n)){for(r=arguments.length,o=new Array(r-1),c=1;r>c;c++)o[c-1]=arguments[c];for(a=n.slice(),r=a.length,c=0;r>c;c++)a[c].apply(this,o)}return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var n;n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,o,u;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(u=o;u-->0;)if(n[u]===t||n[u].listener&&n[u].listener===t){r=u;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],3:[function(e,t,n){function r(){}var i=t.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){"use strict";t.exports=e("./lib")},{"./lib":9}],5:[function(e,t,n){"use strict";function r(){}function i(e){try{return e.then}catch(t){return m=t,y}}function o(e,t){try{return e(t)}catch(n){return m=n,y}}function s(e,t,n){try{e(t,n)}catch(r){return m=r,y}}function u(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._37=0,this._12=null,this._59=[],e!==r&&p(e,this)}function c(e,t,n){return new e.constructor(function(i,o){var s=new u(r);s.then(i,o),a(e,new v(t,n,s))})}function a(e,t){for(;3===e._37;)e=e._12;return 0===e._37?void e._59.push(t):void d(function(){var n=1===e._37?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._37?f(t.promise,e._12):l(t.promise,e._12));var r=o(n,e._12);r===y?l(t.promise,m):f(t.promise,r)})}function f(e,t){if(t===e)return l(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var n=i(t);if(n===y)return l(e,m);if(n===e.then&&t instanceof u)return e._37=3,e._12=t,void h(e);if("function"==typeof n)return void p(n.bind(t),e)}e._37=1,e._12=t,h(e)}function l(e,t){e._37=2,e._12=t,h(e)}function h(e){for(var t=0;t<e._59.length;t++)a(e,e._59[t]);e._59=null}function v(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function p(e,t){var n=!1,r=s(e,function(e){n||(n=!0,f(t,e))},function(e){n||(n=!0,l(t,e))});n||r!==y||(n=!0,l(t,m))}var d=e("asap/raw"),m=null,y={};t.exports=u,u._99=r,u.prototype.then=function(e,t){if(this.constructor!==u)return c(this,e,t);var n=new u(r);return a(this,new v(e,t,n)),n}},{"asap/raw":13}],6:[function(e,t,n){"use strict";var r=e("./core.js");t.exports=r,r.prototype.done=function(e,t){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(e){setTimeout(function(){throw e},0)})}},{"./core.js":5}],7:[function(e,t,n){"use strict";function r(e){var t=new i(i._99);return t._37=1,t._12=e,t}var i=e("./core.js");t.exports=i;var o=r(!0),s=r(!1),u=r(null),c=r(void 0),a=r(0),f=r("");i.resolve=function(e){if(e instanceof i)return e;if(null===e)return u;if(void 0===e)return c;if(e===!0)return o;if(e===!1)return s;if(0===e)return a;if(""===e)return f;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new i(t.bind(e))}catch(n){return new i(function(e,t){t(n)})}return r(e)},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function r(s,u){if(u&&("object"==typeof u||"function"==typeof u)){if(u instanceof i&&u.then===i.prototype.then){for(;3===u._37;)u=u._12;return 1===u._37?r(s,u._12):(2===u._37&&n(u._12),void u.then(function(e){r(s,e)},n))}var c=u.then;if("function"==typeof c){var a=new i(c.bind(u));return void a.then(function(e){r(s,e)},n)}}t[s]=u,0===--o&&e(t)}if(0===t.length)return e([]);for(var o=t.length,s=0;s<t.length;s++)r(s,t[s])})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){e.forEach(function(e){i.resolve(e).then(t,n)})})},i.prototype["catch"]=function(e){return this.then(null,e)}},{"./core.js":5}],8:[function(e,t,n){"use strict";var r=e("./core.js");t.exports=r,r.prototype["finally"]=function(e){return this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})})}},{"./core.js":5}],9:[function(e,t,n){"use strict";t.exports=e("./core.js"),e("./done.js"),e("./finally.js"),e("./es6-extensions.js"),e("./node-extensions.js")},{"./core.js":5,"./done.js":6,"./es6-extensions.js":7,"./finally.js":8,"./node-extensions.js":10}],10:[function(e,t,n){"use strict";var r=e("./core.js"),i=e("asap");t.exports=r,r.denodeify=function(e,t){return t=t||1/0,function(){var n=this,i=Array.prototype.slice.call(arguments,0,t>0?t:0);return new r(function(t,r){i.push(function(e,n){e?r(e):t(n)});var o=e.apply(n,i);!o||"object"!=typeof o&&"function"!=typeof o||"function"!=typeof o.then||t(o)})}},r.nodeify=function(e){return function(){var t=Array.prototype.slice.call(arguments),n="function"==typeof t[t.length-1]?t.pop():null,o=this;try{return e.apply(this,arguments).nodeify(n,o)}catch(s){if(null===n||"undefined"==typeof n)return new r(function(e,t){t(s)});i(function(){n.call(o,s)})}}},r.prototype.nodeify=function(e,t){return"function"!=typeof e?this:void this.then(function(n){i(function(){e.call(t,null,n)})},function(n){i(function(){e.call(t,n)})})}},{"./core.js":5,asap:11}],11:[function(e,t,n){"use strict";function r(){if(c.length)throw c.shift()}function i(e){var t;t=u.length?u.pop():new o,t.task=e,s(t)}function o(){this.task=null}var s=e("./raw"),u=[],c=[],a=s.makeRequestCallFromTimer(r);t.exports=i,o.prototype.call=function(){try{this.task.call()}catch(e){i.onerror?i.onerror(e):(c.push(e),a())}finally{this.task=null,u[u.length]=this}}},{"./raw":12}],12:[function(e,t,n){(function(e){"use strict";function n(e){u.length||(s(),c=!0),u[u.length]=e}function r(){for(;a<u.length;){var e=a;if(a+=1,u[e].call(),a>f){for(var t=0,n=u.length-a;n>t;t++)u[t]=u[t+a];u.length-=a,a=0}}u.length=0,a=0,c=!1}function i(e){var t=1,n=new l(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}function o(e){return function(){function t(){clearTimeout(n),clearInterval(r),e()}var n=setTimeout(t,0),r=setInterval(t,50)}}t.exports=n;var s,u=[],c=!1,a=0,f=1024,l=e.MutationObserver||e.WebKitMutationObserver;s="function"==typeof l?i(r):o(r),n.requestFlush=s,n.makeRequestCallFromTimer=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e,t,n){(function(n){"use strict";function r(e){c.length||(o(),a=!0),c[c.length]=e}function i(){for(;f<c.length;){var e=f;if(f+=1,c[e].call(),f>l){for(var t=0,n=c.length-f;n>t;t++)c[t]=c[t+f];c.length-=f,f=0}}c.length=0,f=0,a=!1}function o(){var t=n.domain;t&&(s||(s=e("domain")),s.active=n.domain=null),a&&u?setImmediate(i):n.nextTick(i),t&&(s.active=n.domain=t)}var s,u="function"==typeof setImmediate;t.exports=r;var c=[],a=!1,f=0,l=1024;r.requestFlush=o}).call(this,e("VCmEsw"))},{VCmEsw:3,domain:1}],14:[function(e,t,n){function r(e,t){var n=null!==e?"{{0}} 分 ("+(e.rating.numRaters>=10?"{{1}}":"少于10")+"人评价)":"抱歉，无法在豆瓣发现对应的书籍资料",r={jd:'<div id="summary-douban"><div class="dt">豆瓣评分：</div><div class="dd">'+n+"</div></div>",amazon:"<div>豆瓣评分:"+n+"</div>"},o=void 0;o=null!==e?i.transform(r[t.name],e.rating.average,e.rating.numRaters):i.transform(r[t.name]);var s=document.querySelector(t.container);s.appendChild(o)}var i=e("./helper");t.exports=r},{"./helper":17}],15:[function(e,t,n){function r(e,t,n,r){return new i(function(i,o){var s=new XMLHttpRequest;s.open(e,t),s.onload=function(){4==s.readyState&&(s.status>=200&&s.status<300?i(void 0==r?JSON.parse(s.response):s.response):o({status:s.status,statusText:s.statusText}))},s.onerror=function(){o({status:s.status,statusText:s.statusText})},s.send(null===n||void 0===n?null:n)})}var i=e("promise");t.exports=r},{promise:4}],16:[function(e,t,n){var r={},i=e("./operation");chrome.runtime.onMessage.addListener(function(e,t,n){switch("PAGE_INIT"===e.text&&n(!0),e.type){case"SHOW_DETAIL":i.showDetail(r);break;case"PAGE_INIT":}}),i.init(r)},{"./operation":18}],17:[function(e,t,n){function r(e){var t=document.createElement("div"),n=[].slice.call(arguments,1);return n.forEach(function(t,n){var r=new RegExp("\\{\\{"+n+"\\}\\}","g");e=e.replace(r,function(){var e=document.createElement("div");return e.innerText=t,e.innerHTML})}),t.innerHTML=e,1==t.children.length?t.children[0]:t.children}n.transform=r},{}],18:[function(e,t,n){function r(e,t){t=t||0;var n=null;for(var i in c)if(c[i].re.test(window.location.href)){n=c[i];break}if(null!==n){var u=document.querySelectorAll(n.selector);if(null==u&&3>t)setTimeout(r(e,t++),1e3);else if(u.length>=1){for(var a=null,i=0;i<u.length;i++){var f=u[i].innerText.match(/ISBN[:|：]\W?(\d{10,})/);f&&f.length>0&&(a=f[1])}null!=a&&o("GET","https://api.douban.com/v2/book/isbn/"+a).then(function(t){e.data=t,s(t,n)},function(e){s(null,n)})}}}function i(e){if(null!==e.data&&void 0!==e.data);}var o=e("./connect"),s=e("./appendToDOM"),u=(e("./helper"),document),c=(window,u.body,{amazon:{name:"amazon",re:/https?:\/\/.*\.amazon\.c[om|n]/,selector:".bucket > .content > ul > li",container:"#dynamicDeliveryMessage_feature_div"},jd:{name:"jd",re:/https?:\/\/.*\.jd\.com/,selector:"#parameter2 li",container:"#summary"}});n.init=r,n.showDetail=i},{"./appendToDOM":14,"./connect":15,"./helper":17}]},{},[16]);